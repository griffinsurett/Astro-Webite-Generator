---
/**
 * /[collection]/[slug].astro
 *
 * Renders individual collection items with structured sections and placeholders for related items.
 */

// Layout imports
import CollectionItemLayout from "../../layouts/CollectionItemLayout.astro";

// Component imports
import Image from "../../components/Image.astro";
import Section from "../../components/Section.astro";
import ContentTemplate from "../../components/ContentTemplate.astro";
import ItemsTemplate from "../../components/ItemsTemplate.astro"; // Imported for future use

// Utils imports
import {
  getCollectionItemPageData,
  generateItemPaths,
  fetchFeaturedItems,
} from "../../utils/collections/";
import ServiceCard from "~/components/ServiceCard.astro";

const { collection, slug } = Astro.params;

let pageData;

try {
  pageData = await getCollectionItemPageData(collection, slug);
} catch (error) {
  // Log the error for debugging purposes
  console.error(error.message);
  // Redirect to 404 if not found
  Astro.redirect("/404");
}

// Destructure data for easier access
const { title, description, icon, featuredImage, pageTitle } = pageData;

// Export the getStaticPaths function
export async function getStaticPaths() {
  return await generateItemPaths();
}
---

<CollectionItemLayout
  title={pageTitle}
  description={description}
  image={featuredImage}
>
  <!-- Main Content Section -->
  <Section className="main-content">
    <article>
      <header>
        <h1>{icon || "ðŸ“„"} {title}</h1>
        <p>{description}</p>
        {featuredImage && (
          <Image
            src={featuredImage}
            alt={`${title} Featured Image`}
            className="item-image"
          />
        )}
      </header>
      
      <!-- Additional content can be added here -->
      <p>
     
      </p>
    </article>
  </Section>

<style>
  .item-image {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    margin-top: 1rem;
  }
  
  .main-content {
    /* Styles specific to the main content section */
  }
  
  .related-items-section {
    /* Styles specific to the related items section */
    margin-top: 3rem;
  }
</style>
