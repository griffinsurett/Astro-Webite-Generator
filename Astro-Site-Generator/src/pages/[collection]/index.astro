---
/**
 * /[collection]/index.astro
 *
 * Renders the main page for a collection, displaying all items.
 */

// Layout imports
import CollectionLayout from "../../layouts/CollectionLayout.astro";

// Component imports
import ItemsTemplate from "../../components/ItemsTemplate.astro"; // Import the updated ItemsTemplate
import CollectionCard from "../../components/CollectionsCard.astro";
import Section from "../../components/Section.astro";

// Utility imports
import {
  formatCollectionName,
  generateCollectionPaths,
  fetchCollectionItems, // Import fetchCollectionItems
} from "../../utils/collections.js";

const { collection } = Astro.params;

// Export the getStaticPaths function
export async function getStaticPaths() {
  return await generateCollectionPaths();
}
---
<CollectionLayout title={`Our ${formatCollectionName(collection)}`} description={`Explore our ${formatCollectionName(collection)} and discover what we offer.`}>
  <Section className="collection-header">
    <h1>{`Our ${formatCollectionName(collection)}`}</h1>
    <p>{`Explore our ${formatCollectionName(collection)} and discover what we offer.`}</p>
  </Section>

  <Section className="collections-list-section">
    <ItemsTemplate
      collection={collection}
      ItemComponent={CollectionCard}
      query={fetchCollectionItems} // Pass the fetchCollectionItems function
      columns={3} // Adjust as needed
      gap="1.5rem"
      viewAllHref={`/${collection}`}
      viewAllText={`View All ${formatCollectionName(collection)}s`} // Optional: Customize button text
    />
  </Section>
</CollectionLayout>

<style>
  .collection-header {
    text-align: center;
    padding: 2rem 0;
  }

  .collections-list-section {
    padding: 2rem 0;
  }
</style>
